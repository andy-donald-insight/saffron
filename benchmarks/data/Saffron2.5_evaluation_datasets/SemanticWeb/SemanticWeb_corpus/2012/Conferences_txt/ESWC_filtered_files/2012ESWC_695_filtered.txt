Clinical Trial and Disease Search with Ad Hoc

Interactive Ontology Alignments

Daniel Sonntag1, Jochen Setz1, Maha Ahmed-Baker1, and Sonja Zillner2

1 German Research Center for AI (DFKI)

Stuhlsatzenhausweg 3, 66123 Saarbruecken, Germany

2 Siemens AG, Corporate Technology

Otto-Hahn-Ring 6, 81739 Munich, Germany

Abstract. We will explain how an LODD application based on diseases,
drugs, and clinical trials can be used to improve the (ontology-based)
clinical reporting process while, at the same time, it improves the patient follow-up treatment process. Specific requirements of the radiology
domain let us aggregate RDF results from several LODD sources such
as DrugBank, Diseasome, DailyMed, and LinkedCT. The idea is to use
state-of-the-art string matching algorithms which allow for a ranked list
of candidates and confidences of the approximation of the distance between two diseases at query time. Context information must be provided
by the clinician who decides on the related-mappings of patient context
and links he wants to follow in order to retrieve disease and medication
information.

Introduction

In many industrial domains such as medical radiology, a vast amount of images
is produced and the medical image annotations must be refined and augmented
during a complex medical workflow. We use several technologies for the semantic
annotation of medical images and radiology reports [10]. The problem is that
these annotations only capture descriptive information, i.e., the clinical obser-
vations, the various identified symptoms, and the discovered findings. But in
practice, clinicians often want to search for higher level information such as interventions and the respective side effects, or associated information such as
related drugs and diseases in the context of identified symptoms, etc. As a matter of fact, expert knowledge about diseases, drugs, and clinical trails is often
not available through internet searches or too imprecise.

Our experiences throughout the THESEUS MEDICO1 and RadSpeech2
research projects (which focus on semantic medical image search and user interaction [12], respectively) have shown us that several types of knowledge contained in Linked Data are relevant for the annotation of the images. In other
words, when radiologists (or other clinicians) examine their patients medical

1 http://theseus-programm.de/en/920.php
2 http://www.dfki.de/RadSpeech/

E. Simperl et al. (Eds.): ESWC 2012, LNCS 7295, pp. 674686, 2012.
c Springer-Verlag Berlin Heidelberg 2012
?

?

?
images they would additionally like to know whether previous diagnoses ex-
ist, if there has been a change in the case, and what kind of medication and
treatment plan is foreseen. This requires the medical images to be annotated
accordingly so that the radiologists can obtain all the necessary information
starting with a computer tomography (CT) or magnet resonance (MR) image,
and the case description in form of a patient record. We will explain how an
LODD (http://www.w3.org/wiki/HCLSIG/LODD) application based on dis-
eases, drugs, and clinical trials can be used to improve the (ontology-based)
clinical reporting process while, at the same time improving the patient follow-up
treatment process (i.e., monitoring the patients health condition and the development of the disease). We will focus on the essential part of ontology matching
between the medical reference ontology, Radlex3 [5], and the available and relevant LODD data contained in DrugBank, DailyMed, and Diseasome which are
mediated through the LinkedCT resources. LinkedCT, see http://linkedct.org,
aims at publishing the first open Semantic Web data source for clinical trials data; it contains more than 60,000 trails, 14,243 conditions, and 67,271
interventions.

Essentially, the important mapping task between LinkedCT and Diseasome
must be seen in the context of a more complex medical workflow which we
will explain in detail. In addition, the mapping of several additional resources
can only be done interactively, at query time, to meet both the data and the
intentions of the clinician who searches for trail and drug information. The reason
for this is that a radiologist can only decide in an ad hoc fashion whether two
proposed equality or related matches are appropriate in a specific patient
and knowledge retrieval context. This paper is structured as follows. Section 2
describes the clinical problem statement and argues in favour of a context-based
interactive approach; section 3 describes the workflow we created in order to
meet the clinical requirements while embedding the context-based interactive
approach into a concrete knowledge retrieval scenario. Section 5 provides a first
evaluation of the approach to meet the clinical requirements; section 6 concludes.

2 Clinical Problem Statement

In our carrier project THESEUS MEDICO, we envision a flexible and generic
image understanding software. Semantics of the images plays the major role
for access and retrieval. The next generation of intelligent, scalable, and robust
search engines for the medical imaging domain should be based on semantic
technologies. With the incorporation of higher level knowledge represented in
ontologies, different semantic views of the same medical images (such as structural aspects, functional aspects, and disease aspects) can be explicitly stated
and integrated.

3 Radlex is a controlled vocabulary developed and maintained by the Radiological
Society of North America (RSNA) for the purpose of indexing and retrieving radiology images and related information. Radlex contains 11,962 domain related terms
(e.g., anatomy pathology or imaging techniques). Synonym information is partially
indicated, such as Schatzki ring and Lower esophageal mucosal ring.

D. Sonntag et al.

A first analysis of the envisioned search functionality revealed that the association between observed diseases (e.g., lymphoma) and different, related types
of the same disease serve as a valuable knowledge resource (as it can be used
for refining the search query) when searching for similar patients and/or clinical
trials. We identified related LODD resources to capture valuable associations
between the various high-level concepts such as diseases, interventions, medica-
tions, symptoms, etc. Those concepts occur within the clinical diagnostic process
and are thus very relevant for defining search queries. The two related LODD
resources have been identified, Drugbank4, Diseasome5, and DailyMed6. Figure
1 shows the identified LODD resources and a potential interlinking.

Fig. 1. Identified LODD resources

Existing medical ontologies for anatomy and disease related aspects (cf. FMA,
RadLex or NCI-Thesaurus) usually focus on one particular domain, such as
anatomy or radiology, and do not cover relations that link concepts from other
domains such as those which link associated findings with diseases. Most medical
ontologies of this scale for anatomy, disease, or drug aspects can be summarised
as: (a) they are very large models, (b) they have extensive is-a hierarchies up
to ten thousands of classes which are organised according to different views, (c)
they have complex relationships in which classes are connected by a number
of different relations, (d) their terminologies are rather stable (especially for
anatomy) in that they should not differ too much in the different ontologies

4 DrugBank is a large repository of small molecule and biotech drugs that contains
detailed information about drugs including chemical, pharmacological, and pharmaceutical data in addition to sequence, structure, and pathway information. The
Linked Data DrugBank contains 1,153,000 triples and 60,300 links.

5 Diseasome contains information about 4,300 disorders and disease genes linked by
known disorders gene associations. It also indicates the common genetic origin of
many diseases. The list of disorders, disease genes, and associations between them
comes from the Online Mendelian Inheritance in Man (OMIM) , which is a compilation of human disease genes and phenotypes. The Linked Data Diseasome contains
88,000 triples and 23,000 links.

6 Dailymed provides up-to-date information about marketed drugs. Human Prescription Labels, OTC Labels, and Homeopathic Labels sum up to several million entries.
?

?

?
(we will show the opposite for the cancer disease parts), and (e) their modelling
principles are well defined and documented.

A variety of methods for ontology alignment have been proposed [13,2,4,1,8,6].
The objective of the state-of-the-art in ontology mapping research includes the
development of scalable methods (e.g., by combining very efficient string-based
methods with more complex structural methods), and tools for supporting users
to tackle the interoperability problem between distributed knowledge sources
(e.g., editors for iterative, semi-automatic mapping with advanced incremental
visualisations [9]). In addition, cognitive support frameworks for ontology mapping really involve users [3], or try to model a natural language dialogue for
interactive semantic mediation [11].

One of the ontology matching problems in medicine is still that, in many cases,
complex ontology matching algorithms cannot be used because they do not scale
to sizes of medical ontologiescomplex methods for ontology alignment in the
medical domain turned out to be unfeasible because the concept and relation
matrix is often on the scale of 100000  100000 alignment cells and appropriate subontologies cannot be created with state-of-the-art methods because of
complex inter-dependencies.

Another problem is that when using those methods, we can only work with
static mapping as a result of an offline matching process in which the mappings
are independent of the context in which they are used. In the context of our
medical use case, however, we learned in discussions with our clinicians that establishing clinical relevant associations between given clinical concepts has the
potential to improve the search functionality. But that comes with the condition of a context-dependent quality and relevance of established associations
(i.e., alignments) between clinical concepts which determines to which extent
the search functionality can be improved.

We argued in [14] that annotating medical images with information available
from LODD can eventually improve their search and navigation through additional semantic links. One outcome of our ontology engineering methodology
[15,13] was the semi-automatic alignment between radiology-related OWL ontologies (FMA [7] and Radlex). This alignment could be used to provide new
connections in the medicine-related linked data cloud. The fact that contextdependency may play a pivotal role for static alignments from FMA to Radlex
was shown in [16]. Why should this problem be more severe in the context of an
online information retrieval task where diseases from LinkedCT and Diseasome
have to be aligned?

Basically speaking, small changes in the nomenclature can make a big differences in the adequacy of the proposed mappings. This is driven by the fact
that, in medicine, usually a very specific difference in the concept names might
make a huge difference for their interpretation (therefore we should not even try
to map LinkedCT and Diseasesome unless there are exact matches.) But the
absence of globally unique identifiers for diseases (the URIs) forces us to provide
the mappings. Instead of trying to infer such mappings on the large scale for
disease data sources (LinkedCT, for example, has only 830 owl:sameAs links to

D. Sonntag et al.

Diseasome but contains more than 4600 different disease URIs), we try to establish an ad hoc mapping. Further, we ask whether static nton mappings between
two medical ontologies are really necessary and represent really what is desired
in a specific query situation. In the following, we will argue that, at least in our
medical usecase, a rather different set of requirements exists.

For example, a clinical expert identifies patient cancer cells in the imaging
data and is sure that they are from type lymphoma. Hence our (Radlex) search
term is lymphoma. In order to decide on the follow-up treatment steps of the
patient, he wants to search for similar patients/trials where similar patients have
been successfully treated (case-based reasoning). Lymphoma diseases of patients
can, however, be distinguished along three orthogonal dimensions:

1. the type (e.g., Hodgkin and non-Hodgkins lymphoma);
2. the stage (e.g., stage I to stage IV); and
3. the grade (e.g., low, intermediate or high grade).

As lymphomas of different type, stage, and grade grow at different rates, they
respond differently to specific treatments. For that reason, clinicians need to
know the particular type, stage, and grade of a patients lymphoma for an adequate treatment. Accordingly, we have to filter out the relevant trails, or in other
words, align the trials according to this complex information background.

For that reason, we cannot rely on semantic/structured-based knowledge models to establish associations for fine-tuning our search space. To the best of
our knowledge, no formal knowledge structure exists that relies these three dimension (type, stage, and grade) in a proper manner/model.

For the same reason, we also did not use a semantic similarity measure.
Initially, it might appear appropriate to use abbreviation lists, synonym sets,
etc. Although it seems to be obvious that purely syntactic (approximate) string
matching techniques are not sufficient to deal with different data representations,
different linguistic surface forms, and missing information about type, stage, and
grade, it is wrong to believe that the potential increase in recall when using such
query expansion only means a little loss of precision.

However, our interactive workflow is designed to increase precision at a stable
recall level as our examples from LinkedCT and Diseasome will show. (The recall
level can, however, be controlled by declaring the thresholds for individual ad
hoc matchers.)

3 Proposed Workflow

Figure 2 shows the proposed workflow.

1. The user inputs a medical term or refers to the existing CT or MR image annotation. In both cases, a Radlex term is derived and used as the
disease name.
?

?

?
2. MEDICO then

executes

a

SPARQL query

an
(approximate) string matching filter to LinkedCT. (We made positive experience with
in Virtuoso
(filter(regex(?LCT diseases name, *disease name*, i)). (This accounts
for the online processing demand as well as the users expectation of the
LinkedCTs first results.)

implemented

SPARQL

that

includes

the

operator

3. The user browses the retrieved trails with a facetted browsing functionality

we implemented (see section 5) and selects the trails he is interested in.

4. Then, he selects a disease from a specific trail.
5. The system now either follows the link to Diseasome (trivial case) or invokes
the interactive, approximate string-based matching procedure when there is
no link available.

6. According to the found disease-URIs and the de-referenced possible drugs
from DrugBank, the user can click further to obtain the highly desired DailyMed contents.

This process is utterly transparent to the user for two reasons. First, during the
direct-manipulation facetted browsing and search interface, he knows exactly at
which stage he is and exactly when additional input from him is required (stage
5). Second, built on the mental model of the retrieval stages and the context
knowledge he has gained by inspecting the patient file, reflecting on the Radlex
term, and following only the disease links he is interested in, the clinician knows
how to interpret the proposed mappings. It becomes clear that the clinician
is not necessarily interested in pure equality (or subsumption mapping), but
uses a more underspecified related-to mapping/alignment. Interestingly, this
related-to mapping only makes sense in this dynamic retrieval process where
he or she uses the proposed mappings as a further anchor point in his extended
search context. In other words, the user defines what he means by the mappings
in an ad hoc fashion. Therefore, we cannot use static mappings at all or record our
mappings as static ones. The question is whether this procedure really enhances
the robustness of the overall search interface in specific, usecase-relevant retrieval
situations (cf. section 5).

4 String-Based Interactive Matching Approach

The idea is to use state-of-the-art string matching algorithms which allow for a
ranked list of candidates and confidences of the approximation of the distances
between two strings. In addition, the individual results must be homogeneous
in the sense that they are comparable and can be combined. The combination
of the results of the string matching approaches is essential because the variety
of similarity functions that exist in literature have specific positive but also
negative characteristics that have to be taken into account and used in the right
way. First, we define the string matching and the under context filter functions.

D. Sonntag et al.

Fig. 2. Workflow of the Clinical Information Retrieval and Ontology Matching Tasks
?

?

?
Definition 1 (String Matching Function). Given a input search term t and
a LODD knowledge repository L, be  a string matching filter function
 : t  L  {(t, l)| l  L  (t, l)}, with  a boolean similarity function s
that is true whenever the terms t and l yield a string similarity according to the
established similarity measure.

Definition 2 (User Context Filter Function). Given a input search term
t, S a set of terms, then we define a user context filter function

user : t  S  {(t, s)| s  S  relevant(t, s)},
with relevant being a boolean function that is true whenever the similarity of the
terms t and s is relevant in the context of the user.

Function  lets us define a threshold on the individual contributors to an aggregate measure of string matches we take into account for the interaction step;
user allows us to formalise the selection step the clinician performs according to
his context information. If user = true, we established an ad hoc related-to
mapping.

We used the similarity measures simW Jaccard, simW Jaro, simW JaroW inkler,
and simed. and aggregated their results to a star recommendation scheme

i=1  : ( = simi) The individual measures
starsT otal, whereby starsT otal =
are defined as follows.
?

?

?
Formally, the Weighted Jaccard measure takes two disease names d1, d2 and
computes (only) the fraction of tokens that are present in both multi-word terms.
?

?

?
simW Jaccard(d1, d2) =
|d
|

|d1| +

 (
?

?

?
simW Jaro(d1, d2) =

td1d2 w(t, R)
|  |Td
td1d2 w(t, R)
|d

|d
|d2| +
|
?

?

?
|d
?

?

?
|
?

?

?
1,d
?

?

?
|

)

The Jaro-Winkler variant of the Jaro measure takes the longest common prefix
of d1 and d2 as length P to compute an edit distance. Letting P
= max(P, 4),
the Jaro-Winkler distance is defined by
?

?

?
simW JaroW inkler(d1, d2) = simW Jaro(d1, d2) +
?

?

?
 (1  simW Jaro(d1, d2)).

The Damerau-Levenshtein Algorithm is implemented as follows: we use the func-

tion simed : N  N  N taking i = |d1| and j = |d2| where i, j  x is defined

by:

simed(0, 0) = 0
simed(i, 0) = i
simed(0, j) = j
simed(i, j) = min{simed(i  1, j) + 1, simed(i, j  1) + 1,

simed(i  1, j  1) + d(d1i, d2j),
simed(i  2, j  2) + d(d1i, d2j1) + d(d1i1, d2j) + 1},

whereby the function d(d1i, d2j) counts the distance between two letters.

D. Sonntag et al.

The more measures we have that agree on two (disease) terms as being
related, the more stars are visible as our recommendation for the clinician.
However, the decision whether the recommendation is in line with the users
expectations is taken by the clinician and includes the outcome of user.

For example, n-gram measures such as Weighted Jaccard make it possible
to measure the similarity based on specific words and ignore others which are
expected to be unimportant. But how should we know which tokens are unim-
portant? Formally, the Weighted Jaccard measure takes two disease names d1, d2
and computes (only) the fraction of tokens that are present in both multi-word
terms.

5 Evaluation

We evaluated the results of our individual similarity measures and found some
special characteristics of the measures when applied to our specific data. The
Weighted Jaccard method is useful to crop off stop words like disease as in
Castlemans Disease to map against Castleman, but is completely useless
for, e.g., the stages of a disease case, a factor extremely important for lymphoma cases. This outcome reveals that when using this measure for medical
linked data, it would be based on the wrong assumption that medical concept
names contain negligible tokens. But our staging information and related type
information is coded in those tokens. For example, the LinkedCT terms Lym-
phocytic Leukemia, L1 and Lymphocytic Leukemia, L2 differ only in the
stage number, but this information is essential for finding related trials and
drugs.

But also the traditional string similarity measures such as simed cannot be
used without caution. For example, in [16] we emphasised (in the context of
the FMA ontology) that it contains closely related concepts such as Anterior
cervical lymph node and Set of anterior cervical lymph nodes which could
not be identified as duplicates with the simed function. The variation of the
linguistic surface forms might vary even to a greater extend when taking multiple
ontologies (i.e., LinkedCT and Diseasome) into account. On the other hand,
simed works very well in identifying related staging cases when only the stage
numbers or similar sub-expressions are different (cf . the Lymphocytic Leukemia
L1 / L2).

As a result of the observation that several distance functions have different
performances depending on the characteristics of the data (such as length of
the string, token permutations, etc.) we evaluated our ensemble measure with
the star recommendations. Since the functions are independently applied to
the disease names d1, d2 and aggregated into a combined measure by specifying the thresholds and weights of the individual distance function calls, a
vast improvement in the robustness could be achieved. A closer examination of
the disease names stored in LinkedCT and Diseasome provides an explanation:
many disease name contain long digit sequences, for instance G09330582163324
(LinkedCT). In most cases the digits refer to important type, stage, and grade
?

?

?
Fig. 3. Mantle Cell Lymphoma as input from LinkedCT

Fig. 4. Mantle Cell - Choice box for the proposed and selected related-mappings to
Diseasome

information which is covered by the combined measure. The type, stage, and
grade information we finally optimised for, are the following:

1. the type of the disease: Diabetes Mellitus, Type 1 , Diabetes Mellitus,

Type 2,

2. the stage of the disease: Early Stage Breast Cancer (Stage 1-3),
3. the age of the patient as an indirect type classification : ICU Patients 18

Years or Older,

4. the date of the disease outbreak: 2009 H1N1 Influenza,
5. genetic information; location of deleted region in the chromosome: 22q11.2

Deletion Syndrome.

We then evaluated the interactive procedure in the context of our lymphoma
case. The lymphoma case reveals that LinkedCT enumerates 459 lymphoma
disease URIs (and Diseasome only 25 URIs) with the same name observations.
Since either the LinkedCT term or the Diseasesome term often lacks context
information, we can only rely on the interactive workflow because the context
is provided by the context factors explained aboveand which are accessible to
the expert while focussing on the suggestions the system provides. Here is an
example of the individual measure outcomes for Mantle Cell Lymphoma from
LinkedCT (figure 3), for which no links to Diseasome exist.

The aggregated star recommendation is attached to the suggested choice

box for the as hoc related mappings (figure 4).

D. Sonntag et al.

Fig. 5. Results of the Trial search

Fig. 6. Display and Selection of the Proposed ad hoc Mappings

The choice box is being displayed within the facetted browsing tool. Our tool
allows a user to filter thousands of results according to the best-ranked string
matches and linked data relations in a convenient way. Clinician can retrieve
the trails they might be interested in in just a few seconds. We implemented
the graphical user interface by using open-source knowledge management tools
?

?

?
such as Exhibit, see http://www.simile-widgets.org/exhibit/. Figure 5 shows the
embedded iPad GUI widget at stage 4 of the proposed workflow. The circle below
indicates the trivial matching case - an equality link was provided by LinkedCT.
The circle above shows the interesting case, the Diseasome disease is unknown.
A click on a particular Stage I, II, or III lymphoma case evokes the ad hoc
similarity search which results in the interactive mapping suggestion displayed
in figure 6.

6 Conclusion

We explained how an LODD application based on diseases, drugs, and clinical trials can be used to improve the clinical reporting process. In order to get
information about trails, drugs, and diseases, several LODD sources can be addressed and the contained knowledge can be combined. The clinical problem
statement suggested that in order to make the application useful for improving
the patient follow-up treatment process, specific non-existing mappings must be
provided. The important mapping task lies between LinkedCT and Diseasome
in the context of a more complex medical workflow which we developed. We
argued that ad hoc interactive string-based ontology alignments should be used
to propose several ad hoc mappings to the user. The user can then verify them
at the knowledge retrieval stage while using the facetted browsing tool which
implements the graphical user interface of the proposed workflow. An evaluation has shown that the interactive approach is useful and that underspecified
related mappings are often more useful than precise equality mappings in
the medical domain. In general, the discovery of such related links which are
typed, dynamic, and bound to a specific user, data, and application context,
should be an active research area.

Acknowledgements. We would like thank all colleagues at DFKI and all partners in the MEDICO and RadSpeech projects for their valuable contributions
to the iterative process described here. This research has been supported by the
THESEUS Programme funded by the German Federal Ministry of Economics
and Technology (01MQ07016).
