Multi-Modal Definite Clause Grammar
Hideo Shimazu , Seigo Arita , and Yosuke Takashima
Information Technology Research Lal ) or ~ tories , NEC Corporation
4-1-1 Miya.zaki , Miya . mae Kawasaki , 216 Ja . pan
sh?mazu , arita , yosuke@joke . cl . nec . co . jp

This paper describes the first reported grammatical framework for an mltimodal interface  . Although multimodal interfaces offer the promise of a flexible and user fl'i endly means of human -coml  ) uter interaction , no study has yet appeared on formal granunatical f'l'ame-works for the ln  . We have developed MultiModal Definite Clause Ch ' ammar  ( MM-I ) CG )  , an extension of Definite Clause Gramumr . The major features of MM-I ) CG in ch , deeal ) ability to handle an arbitrary mlmber of modes and temporal information in gramma rules  , l:ur-ther , we have developed MM-DCG translator to transfer ules in MM-DCG into Prolog predicates  . 
1 Introduction
This paper describe stile first reported grammatical fi'a mework for a multimodal interface  . Specifically , the authors have developed MM-DC . G ( MultiModall ) cfi-nite Clause Gra , nmar ) , an extension of I ) CCI\[Pereira and Warren , 1980\] for l nultm3odal input processing . 
The major features of MM-DCG include capability to handle an arbitrary nn  , n ber of modes and temporal information in grammar ules  . 
The motivation behind this research was two-foht.
First , the extension to multimodal was found t . o be the minimum requirement \[ brnatural language interface systems to be insta  . lled in realal ~ plications . We have developed natural language interface for relational database  ( RDB ) \[Shimazu et . al . , I9!)2; Arita et . al . , 1992a ; Arita et . al . , 1992b\] . Spoken user queries are transformed into SQL specifications  , and dispatched t . oR DBMS . The retrieved results are displaye data computer terminal  . The results include not only table forms but also picture images  , like Figure 1 . When users see picture images on the terminal , they naturally want to generate following queries by referring to such picture images  . For example , they want to say , "Show me the interior of this one " or " Are there the same type of carsas thise ar " while pointing at a specific picture on the display  . If such multimodal utterances be accept . able , the natural language interface will be more practical Figure I : Natural Language Interface Screenhnage enough to be used in many realworld applications  . 
Second , nost ; udy has yet appeard on developing for-real grammatical fi'amework for multimodal interfaces  . 
Although there have been many researches on multimodal systems  , these systems are built as task-specific expert systems  . The capability of such systems to process multi -moda  . l inputs is too limited to interpret complex multimodal expressions  . This is mainly due to the fact that they have not developed their systems on for-nml grammatical framework for multimodal interfaces  . 
MM-DCG is the first reported grammatical framework for a multimodal interface  . Multimodal input processing rules can be written in MM-I  ) CG simply and effectively . Rules in MM-I ) CG are translated into Prolog predicates easily . 
2 Multi-Modal Input Processing
Consider a query ( . ' xample to an mlti-modal interface with a screen image like Figure  .  1 . A user states " Can this , attach this , " pointing at a picture on the screen and clicking the mouse during the first " this " and then choosing an item fl'om all lenu during the second  . The system must realize that the first point is to a specific autonaobile and the second is to the menu item " CD player "  . After integrating the two mouse pointing events into the two " this " in the utterance  , the system nmst create an internal representation f this query that conforms to SQI  , specifications . \[ ntiffs example , even if the order of the two mouse clicking events is opposite  , but the interl > retation will I > ei\]l ( > l'edillcult . In order to interpret such complex (: ombinatio , so flmllti-modal inputs , the following requirement . sexist : ( 1 ) Modes should be interI ) reted equally an < tin-del ) ende . ntly . In <: onventiomtl multimodal systems , natural language mode plays a major role , amlother modes such as mouse input mode are auxilia  . ry . Inl ) uts of auxiliary modes are merged into < ; or resl ) onding at-ural language expressions iu as url'ace level  , and the merged natural language query is interpreted I > y con-vention at l natural language parsers  . Therefore , varie . l . y of accepte<l multi-modat lexl > r <' . ssions is very limited . 
l lowever , If each t node is treated wit , Is the same man-sler as that of ssats ls'atl\] allgSH/geIlSOde  , Syllldt X as sds ( , -mantics of iulmts of each mode are ( lefim ~ d with gram-sBar for lnulat ; ion . ' Fhus , ccmq ) lexexl ) rcs skmscanl > e defined declaratively and more easily  ( 2 ) Mode in t < ~' rI ) reta ; ion should be r < 4' (! l'red to one another , lnl ) uts or each mode should be interpreted independently  . I lowever , the interl ) retatiol ~ of such inputs should be referred I > y other l node interl  ) re-tattions . There are aln biguities which arc solved only by integrating partial interl  ) retabi<msoF related modes . For examl > le , if user states " tiffscar " , l > o i ~ t t i t ~ g at an object which is overlal > l ) ed on the . car object . , the alnhiguity of the object pointing must he solved by conHlaring  ( lie two mode interpretations . 
(3) Mode interpre , tai ; icm should handle temI > oral inthrmation . Tetlq > or aliuformation of inputs , such as input arriving time , in l , erwd between two in l ) uts , plays an important role to i , ~terl ) rctmull . i-modal inputs . 
Consider an exas nl > le that a user states "\] low muc\[s is this car "  , and points at , a cari > icture alitt . leafter the utterance . If tile interwdisthree . scco~sds , the l > ointing event should be integrated with " this car " in the ut-  . 
terance . I lowever , if the il H . erwd is three illi~sles , tile event should not I ) eint . egraled . 
3 MM-DCG Design l ) ecisions
This section describes major design decisions made in developing  MM-1  ) CG . I h : e a use MM-I ) ( X ; is n superset of I ) CG , everything possihle is lI ) (!G is also possibhe in MM-I ) CG . l lowever , two major extensions are provided 3 . 1ll . eceiving Multiple Input Streams MM-I ) CGcau receive arbitrary mind > or so \[' different , input streams , while I ) CG receives only ore ! , I '; ach mode is assigned an individual stl'ealll . Tlscrefore , a single gramma rule in MM-1) (: C , can allow the coexistence of grammatical categories in ditSwent modes  , thus allowing for their integration . In addition , coa . extsensitiw ~ inlbrnmtion can be in l . crclmnged among cattegories of different modes in a single rule  . Figure 2 illustrates a multimodal input processing luodule which accepts three independent streams  . 
~' word word word word word click click
Multimodal Ingrator
MM-DCG Rules : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : : N ~ i ~ i : ~& li : i ~ a ~ ? : ! : i ! iii !iiil 
Prolog I , nterp feterk.
l , ' igm . e2: Multimodal Input Processing Module
T1 T2 T3 T4 T5 T6
I/II(tl , t2 , " the ") ( t3 ,  14 , " blue ") ( t5 , td , " car ")
Chronological Diroclion
Figure 3: Time Calculation of Instantareal Semantic ( i : attegorics 3 . 2 Cal <: ulating the Instantiated Time of
Grammatical Categorh , , s
Inputs of a single mode invariably have ordering relations among them  . A parser like DCG uses such order relations to amdyze syntax  , semantics , and pragmatics . 
h,pul . s of d iff ere . nt modes , however , have no inherent order in grehd . ions . Therefore , MM-I ) CG requires timat-t . a chmel H : of both the beginning time and the end time to each individual piece or input data  . MM-DCG automatically calculates the beginning time and the end tiuw of any  lew4 of grammatical categories generated during Imrsing  . 
MM-I)C ( ; translator automatically generates the code which calculates the begins fing and end times of any body goal in at gramma rule  . The translator generates two extra argnments to store the beginning time and end time into each head and body goals in MM-I  ) CG rules . The begtruing time argument of the head is unified with the begtruing time argulner  , t of the first hody goal . The end time a . rgu , nent of the head is uniIied with the end time argument of the last body goal  . Fig-m'e 3 shows the argtH\]lellt organization of noun_phrase rule  . 
Thus , for example , if a noun phra~se category is in-stantiatcd by pa . rsing " tile blue car " , the beginning time of the instant a real category becomes equal totile begin-  , ring tilsle of " the " , and the end time of the category is equal to the end time of " car "  . 

Mouse input stream ( button(left ,  (10 , 20)) ( button(left > (7 ,  25)) 9
Time Interval
Figure 4: Thneout C . oncept
MM-DCG requires any input frolue very mode to have begimfing and end times  . Thus , each item in an input sequence will haw ; the following sl . ructilre : input ( beginning-time , end-time , < actual input > ) which means that the actual input was inputted froll l start-tlme and completed at  . end-time . Adding of this time information is easy for all y of the SOl'l  . softill ) ill . 
modes we are considering ( i . e . speecll recognition , keyboard inputs , mouse 1) oint , ing , el . c) . 
One other iml ) or ta . nt item of notation : \[ l ' a variable is explicitly bound within at goal  , the variable ret . urus the beginning and end times of the goal hi the R  ) rlll of a finletor . Thus,
Time ^ goal means that " if goal succeeds , the beginn hlgtime and end time of tile goal are rctnl'nedill the wu'iableTime  . " Using the time i if l brmation of instautiated categories  , rule writers can define chronological collstra . ints aniong categories , for exaniple , the following descriptiot lexpresses a constraint hat pronoun category and pointing category n nist be both instantiated wittliua fives e  ( :-onds~
Tl'pronoun , T2"point?ng , Dillis T2-TI , Diff < 53 . 3 Defining Timeout in I . ules Timeout is a constraint of intervals belween an input and its succeeding input of n  . streanl ( See Figure 4) . If an interval between inputs of a strean he comes larger than a threshold defined in gralluiu/rrllles  , tile tinie out occurs , and tiles trean i is regarded C . llipl . yl . einporariiy although there still exist inputs in it  . .
The following points rule llleaus that " l/eceive i/louse clicking inputs wllile  , tile interval between I . wo inputs is less thau 5 seconds oriln ti \] a stream I ' Je coines null , then return the list of the hlputs " points ( E \] ) --> mouse:E\] ( s . o ) . 
points ( \[PtIPts\] ) --> point ( Pt )   , poin~s ( Pts ) point ( Loc ) --> mouse :\[ button ( left , Loc )\] . 
4 Rules Written in MM~DCG 4.1 Syntax
MM-DCG syntax extends I ) CG in the following ways : ? Abody goal mayo , ' may not be specified its con-smiting stream : Irl ' abody goal consumes inputs from specific streams  , the goal must be accompanied by the stream names . For example , tile following rule noun_phrase --> keyboard :pronoun  . 
nieans that " if the pronoun category is found which is generated by inputs from the keyboard stream  , noun_phrase is found . " If a body goal is not accom-pa , iied by any stream name , the goal is regarded as consunling sonicamount of inputs fi'om all modes  . 
For example , the following rule noun_phrase-->noun . 
lneans that " if the noun category is found which is generated by inpufos frorn certain streams  , noun_phrase is found . " ? A terminal synibol should always be accompanied by a specific stream name : 
For example , the following rule pointing --> mouse :\[ button ( left , loc(X , Y )\] . 
means that " if a flmctor button(left , Ice(X , Y )) is found at the mouse strea . nl , pointing is found " . 
4.2 lime Example
To demonstrate how MM-I ) CG rules are written , this section describes a simple grammar needed to handle " object " with multimodal inputs  . 
Figure 5 shows the definition of " object " . A rule writer defines existing slmeams pecifically using a unit clause  , active_stream/1 . " Object " are specilied by using eitller one of the abow ~' i nodes or their combinations  . 
The first object/ldelh fition interprets natural language specifh : ations such as " the blue car "  . The second object/linter prets anlouse clicking which points at a  . 
sl > ecificgrai > hical object on the display . The third object/l definition iz d . erprets a combination of a natural language utterance and ainous epointing  , such as stating " the bhlecar " while pointing at a graphical object oil the display  . A natural language utterance is interpreted at . the noun_phrasebody goal , and the identified object is bound to Objl . A mouse pointing event is interpreted at the pointing body goal  , and the identified object is bound to Obj2 . 
Then , Objland Obj2 are compared their values in a Prolog predicate enclosed inside curly brackets and  . Both variables honld be equal . If not , because the interpretation of noun_phrase or pointing must be wrong  , bacld . racking occurs . 
As seen above , a single grammar rule in MM-I ) CG can allow the coexistence of grammatical categories in different niodes  , thus allowing for their integration . In addition , teniporal and context sensitive information can be interchanged aniong categories of different modes in a single rule  . 
834 ~ , stream definit : ion active_stream ( speech , mouse , keyboard ) . 
? , For natural language mode object ( 0 bj ) --> not m_phrase ( \[Ibj )  . 
noun_phl-ase ( Obj ) -~> article , adjective ( Att : t , A value) , noun ( Noun ) , attribute ( type , Noun , 0bj ) , attr ~ bute(Attr , Ava \] ue , 0bj ) . 
article --> ( speech or keyboard ) :\[ the\] . 
adjective ( color , blue ) --> ( speech or keyboard):\[b\]ue\] . 
noml ( automobile )  --->  ( speech or keyboaid ) :\[ car \] . 
~. Formouse mode object ( Obj ) = -> po~nting(Ubj).
poillting ( \] bj ) -~> mouse :\[ button ( \] efL , lee(X , Y ))\] , attribute ( location , ( X , Y ) , 0bj ) ,  ? , For combinations of modes object ( Objl ) --> noun phrase ( t ) bji )   , pointing ( Obj2) , 0 bjl == 0 bj 2 . 
Figure 5: (; raml nar I ) cs criplion l " , xample Using MM-I)C ( ; 5 Translating MM-I ) CG into Prolog This secl , ion describes lrans la Lioll lcchniquoso\['MM-I ) C (  ; rules into Prologi ) redi (' alcs , l " irst , we explain the translat , i on method of I~IM . I ) (:(; ruh ! s with a single stream . Even in the single , strca . ic as ~' , MM-I )(?(; translation method is dill'err , hi from I halof I )( I(' ,  . Then , their a . sial , i onteclud qu < e wit . htlml liph'Sll'ea HiS is CXpiened . 
5 . 1MM-DCG Transla ; ion for a Single Stream A head and body goals i  . agra . mtarridear ~ , Ire , slated into ; ~ predicate with four exLraal'gunt cl~l . sL wo for ihe beginning time midl , he endlinle and I wot Lr ~' x pressing a e OllSttllledill\[  ) ll , Si , l'i ! all l . '\[' h <! l ; ll . \[ l ! r two al'gtl Htelll Sa retim same its the geller al  , cdal'g/llllCIll , SW\]I (! III ) ( I(~ruie , % are translated into I h'o log prmlicai . es . 
The beginning tinl carglmll ml , of l , hchead is uni/icd with i , hebegin , ringl , iln Carguuleul , of i , helirsl , body goal , and the end t ; in l cargumenl , of the head is unilied with the elKI , in le of the last , body goal . ForeXalllp\]e,\[,h , . ! following MM-I ) C(; rule ( for a single , % r < un ): noun phrase --> article , adj , noun . 
is translates in l , o:noun_phrase(T0 , T , N 0 , N ) :- article(T0 , TI , NO , Nl ) , adjective ( T2 , T3 , NI , N ~) , noun(T 4 , T , N2 , N ) . 
or , in Fmglish,
There is a retail-phrase l ~ et u , ecnNO and N if there is an article I wtw ccnNO and NI  , aud if there is an adjectiw ! I , etu , ~ , , , uNI and N-) , aml if there is a noun het wec'nN2 and N , The noun-t ~ hrasc starts at (1'0 , nmlcm/satT . The article starts at TO , a11 deu , ls at TI . " l'lwa+(j (' ctiv c starts at T 2 , and ends at "1'3\[l'hctloutl starts at T4 , am lends at T . 
A rule with a terniinal syll lboI is II ' all S\]alcd illlOaullil  ; ciallse , l " or examl ) lc , noun --> keyboard:\[window\] . 
trails \ [ aLes into : noun ( Ts , Te , \[ input(Ts , Te , + < window '') IN\] , N ) . 
Af uncL or input/3 is inseri , cd into the third argunmnt for lllili , ~ the input , s\[ , rC alll of , he+predicate . The third al ' ~ lllllOnl , of t , het'llllCl\[ , or input/3 is the act , ualin put item , the " wimh m , " string in this example . 
The first and second al'g Uillelll , of input/3 is unitied wiLh the first and second argument of this unit clauser ~ spectiw ! ly  , Th , ~ refore , if a string " window " is input vial he keyboard ~ t  , reum , the noun category is instant a real , and the beginldng and end time of the noun category is Lllesameast  , llestart and ( ! lidLime attached to the " window " input . 
5.2 Exte,nsion ; oArtdtrary Nmntmrof
Strealli S
Exl , ension frol . a singlest , reamt on ml tiple streams is easy . E ; t ( ' hstream needs four extra arguments-two for t , imiugiu form nt , iou and two for express i . ga consumed input Si . l ' Calll , Thus , i \[' there aren modes , 4 n arguments arc ~ . ldcd into head and goals argunlenl ; s . 
For e ? an ll~lc: , if l , hcreare two streams , the noun_phrase defiuitioa in Lhc previous section is translated into the following prolog l  , ' edicaws with eight (2x4) extraar-gilll lell\[ , S:llOUU_i3hrase(TxO , T x , ~IxO , Nx , TyO , T y , NyO , Ny ) :- article(TxO , T xl , NxO , Nxi , TyO , Tyl , NyO , Nyl ) , adjective ( Tx2 , Tx3 , Nxl , N x2 , Ty2 , Ty3 , N y i , Ny 2) , noun(T x 4 , Tx , Nx2 , Nx , Ty4 , Ty , Ny2 , Ny) . 
5 . 3 Ext rac t ions o f Tempora l In fo rmat ion If there is at variable bindi \] tg within a goal like  , 
Tinle-goal the goal is t , rans lat , cd into a con , jullcl , ion of two body goals ( for using lemode ) :  ( goal ( T 0 ,  "1'1 , R 0 , R ) , Time--(T0 , T1)) to a list of n time pairs , such as ~ n't wo modes : ( goal ( TxO , Txl , NxO , gxl , TyO , Tyl , NyO , Nyl) , 
Time =\[( TxO , T xl ) , ( TyO , Tyl ) \]  )   6 Related work The idea of understandill g multimodal inputs in conjunction with each other  , as presented in this paper , is not particularly new . The idea of an nllti-n/odal input combining motions and pointing has been explored in a number of contexts  . The classic 1980 paper " I > ut-That-There "\[ Bolt ,   1980\] describes a nearly system that procedurally combined voice and gesture inputs  . This idea was further explored in terms of integrating natural an-guage and pointing by \[/ Iayes  ,  1988\] , who related nmlti-modal inputs to anaphoric reference in imtural language processing  , particularly to t . he work o\['\[Grosz , 1977\] and\[Sidner ,  1979\] . Recent work in the design of direct manipulation interfaces has also explored the notion of integrating a set of diverse inpuls  . Othe . rpalm rs exploring multimodal interfaces include \ [ Allgayer el  . al . , 1989; Cohenel . al . , 1989; Cohen , 1991; Kobsa et . al . , 1986; Wahlster , 1989\] . Most of this work , howew . ' r , hastb-cused on the application of the ideas , and not on the principles for integrating the different inputs  . 17 Conclusion In this paper , we haw ; proposed the use of a grammar for dealing with inpute wmt  . sinal mdti-modal user interface . We proposed MM-I ) C(~ , a novel gralnmatical framework for a multimodal in l  . er face . MM-I ) (: G is an extension of 1) CG for r null . i-modal inpuls processing . 
The major features of MM-D ( : Ginchldccapability to handle an arbitrary nnnaber of modes and feral  ) oral information in grammar rules . We show edits use \[' or a simple example . The translation technique of the MM-DCG rules into Prolog predicates was also presented  . 
An initiM implementation of MM-I ) CG has been developed at NEC Corporation , all discurrently being used for the development of al  ) rototype mull . i-modal interface . 
References \ [ Allgayer el . al . , 1989\] Allgayer, . \] . , Jansen-\Vinke . ln , R . , reddig , C . , and Reithing N . , \[Arita et . al . , 1992a \] Arita , S . , Shimazu , H . , and ' lakashima , Y . , " I ~ or l . able Natural Language Interface ", Proc . of I . he8th I\] nnlan Interface Symposium ,  1992 , ( in Japanese) . 
\[Arita et . al ., 1992b\]
Arita , S . , Shimazu , Ii . , and Takashima , Y . , " Siml)le + Robust = Pragmatic : A Natural Lal , guage Query Processing Model h ) rC ard-type 1 ) at a bases " , Proc . of the 13th Annual Conference of Ihe Cogldtive Sc:ience . 
Society , 1992.
1A survey of this work is beyond I\[le scope O \[' this paper  , the interested reader is directed to the review in\[Shneiderman  ,  1991\] . 
\[Bolt , 1980\] Bolt , R . A . , " Pat-That There : Voice and Gesture at the Graphics Interface "  , Computer Graphics 14 ,  3 ,  1980 . 
\[Clocksin and Mellish , 1981\](31ocksin , W . F . and Mellish , C . S . , " Progrannning in Prolog " , Springer-Verlag ,  1981 . 
\ [ Cohen et . al . , 1989\] Cohen , P . R . , l ) alryml)le , M . , Moran , I) . B . , Pereira . , F . G' . N . , et al , " Synergistic Use of Direct Manipuhttion and Natnral Language "  , Proc . of CHI-88, 1989 . 
\[Cohen , 1991\]Cohen , P . R . , " The Role of Natural Language in a MultinlodM Interface "  ,   1991 lnternation M Symposium on Next Generation Human Interface  ,  1991 . 
\[Grosz , 1977\] Grosz , B . " The representation aduse of focus in a system for understanding dialogs  , " Proc . IJCAI 1977, Boston , MA . 
\[ilayes , 1987\] Hayes , P . J . , " Steps towards Integrating natural Language and Graphical Interaction for Knowledgebased Systems  "  , Advances in Artificial Intelligence-II , 
Elsevier Science Publishers , 1987.
\[llayes , 1988\]llayes , P . J . , " Using A Knowledge Base To Drive An Expert Systenl Interface With A Natural Language Component  , " in J . II endler ( ed . ) Expert Systems : The User h ~ terface , Ablex Publishing ,  1988 . 
\[Kobsa et . al . , 1986\]Kobsa , A . , Allgayer , J . , Reddig , C . , Reithing , NI , Schumauks , D . , l Iarbusch , K . , and Wahlster , W , " Combining Deictic Gestures and Natural Language for Referent Identification "  , Proc . of
COLING-86, 1986.
\[Pereir and Warren , 1980\] Pereira , l " . , and Warren , I) . II . D . , p " Definite Clause Grammars for l , angua . ge Analysis - A survey of the Formalism and a Comparison with Augmented Tl ' ausitiol lNetworks  "  , Artificial Intelligence , vol . 13, no .  3, 1980 . 
\[Shimazu et . al . , 1992\] Shimazu , 11 . , Arita , S . , and Takashima , Y . , " Design Tool Combining Keyword Analyzer and Case-Based Parser \[' or Developing Natural Language I  ) at a Base Interfaces " , Proc . of COLING-92, 1992 . 
\[Shneiderman , 1991\] Designing The User Interface , Addison Wesley Publ . , Reading , MA . 
\[ Sidner , 1979\] Sidner , C . Towards a computational theory o\] definite anaphora comprehensioniEnglish Discourse  , 
T1-537, MITAIl , ab , Cambridge , Ma.
\[ Wahlster , 1989\] Wahlster , W . , " User and discourse , models for multimodal communication " , in a . W . Sullivan and S . W . '\]' yler , editors , Intelligent User Interfaces , chap-ter 3 , ACM Press Frontiers Series , Addison Wesley Publishing ,  1989 . 

