Proceedings of the 49th Annual Meeting of the Association for Computational Linguistics:shortpapers , pages 620?624,
Portland , Oregon , June 1924, 2011. c?2011 Association for Computational Linguistics
Generalized Interpolation in Decision Tree LM
Denis Filimonov??
?Human Language Technology
Center of Excellence
Johns Hopkins University
den@cs.umd.edu
Mary Harper?
?Department of Computer Science
University of Maryland , College Park
mharper@umd.edu
Abstract
In the face of sparsity , statistical models are often interpolated with lower order ( backoff ) models , particularly in Language Modeling.
In this paper , we argue that there is a relation between the higher order and the backoff model that must be satisfied in order for the interpolation to be effective . We show that in ngram models , the relation is trivially held , but in models that allow arbitrary clustering of context ( such as decision tree models ), this relation is generally not satisfied . Based on this insight , we also propose a generalization of linear interpolation which significantly improves the performance of a decision tree language model.
1 Introduction
A prominent use case for Language Models ( LMs ) in NLP applications such as Automatic Speech Recognition ( ASR ) and Machine Translation ( MT ) is selection of the most fluent word sequence among multiple hypotheses . Statistical LMs formulate the problem as the computation of the model?s probability to generate the word sequencew1w2 . . . wm ? wm1 , assuming that higher probability corresponds to more fluent hypotheses . LMs are often represented in the following generative form : p(wm1 ) = m ? i=1 p(wi|w i?1 1 ) In the following discussion , we will refer to the function p(wi|w i?1 1 ) as a language model.
Note the context space for this function , wi?11 is arbitrarily long , necessitating some independence assumption , which usually consists of reducing the relevant context to n ? 1 immediately preceding tokens : p(wi|w i?1 1 ) ? p(wi|w i?1 i?n+1) These distributions are typically estimated from observed counts of ngrams wii?n+1 in the training data . The context space is still far too large ; therefore , the models are recursively smoothed using lower order distributions . For instance , in a widely used ngram LM , the probabilities are estimated as follows : p?(wi|w i?1 i?n+1) = ?( wi|w i?1 i?n+1) + (1) ?( wi?1i?n+1) ? p?(wi|w i?1 i?n+2) where ? is a discounted probability1.
In addition to ngram models , there are many other ways to estimate probability distributions p(wi|w i?1 i?n+1); in this work , we are particularly interested in models involving decision trees ( DTs).
As in ngram models , DT models also often utilize interpolation with lower order models ; however , there are issues concerning the interpolation which arise from the fact that decision trees permit arbitrary clustering of context , and these issues are the main subject of this paper.
1We refer the reader to ( Chen and Goodman , 1999) for a survey of the discounting methods for ngram models.
620 2 Decision Trees
The vast context space in a language model mandates the use of context clustering in some form . In ngram models , the clustering can be represented as a k-ary decision tree of depth n ? 1, where k is the size of the vocabulary . Note that this is a very constrained form of a decision tree , and is probably suboptimal . Indeed , it is likely that some of the clusters predict very similar distributions of words , and the model would benefit from merging them . Therefore , it is reasonable to believe that arbitrary ( i.e ., unconstrained ) context clustering such as a decision tree should be able to outperform the ngram model.
A decision tree provides us with a clustering function ?( wi?1i?n+1) ? {? 1, . . . ,? N }, where N is the number of clusters ( leaves in the DT ), and clusters ? k are disjoint subsets of the context space ; the probability estimation is approximated as follows : p(wi|w i?1 i?n+1) ? p(wi|?(w i?1 i?n+1)) (2) Methods of DT construction and probability estimation used in this work are based on ( Filimonov and Harper , 2009); therefore , we refer the reader to that paper for details.
Another advantage of using decision trees is the ease of adding parameters such as syntactic tags : p(wm1 ) =
X t1...tm p(wm1 t m 1 ) =
X t1...tm mY i=1 p(witi|w i?1 1 t i?1 1 ) ?
X t1...tm mY i=1 p(witi|?(w i?1 i?n+1t i?1 i?n+1)) (3) In this case , the decision tree would cluster the context space wi?1i?n+1t i?1 i?n+1 based on information theoretic metrics , without utilizing heuristics for which order the context attributes are to be backed off ( cf.
Eq . 1). In subsequent discussion , we will write equations for word models ( Eq . 2), but they are equally applicable to joint models ( Eq . 3) with trivial transformations.
3 Backoff Property
Let us rewrite the interpolation Eq . 1 in a more generic way : p?(wi|w i?1 1 ) = ? n(wi|?n(w i?1 1 )) + (4) ?(? n(w i?1 1 )) ? p?(wi|BOn?1(w i?1 1 )) where , ? n is a discounted distribution , ? n is a clustering function of order n , and ?(? n(w i?1 1 )) is the backoff weight chosen to normalize the distribution.
BOn?1 is the backoff clustering function of order n ? 1, representing a reduction of context size . In the case of an ngram model , ? n(w i?1 1 ) is the set of word sequences where the last n ? 1 words are wi?1i?n+1, similarly , BOn?1(w i?1 1 ) is the set of sequences ending with wi?1i?n+2. In the case of a decision tree model , the same backoff function is typically used , but the clustering function can be arbitrary.
The intuition behind Eq . 4 is that the backoff context BOn?1(w i?1 1 ) allows for more robust ( but less informed ) probability estimation than the context cluster ? n(w i?1 1 ). More precisely : ? wi?11 , W : W ? ? n(w i?1 1 )? W ? BOn?1(w i?1 1 ) (5) that is , every word sequence W that belongs to a context cluster ? n(w i?1 1 ), belongs to the same backoff cluster BOn?1(w i?1 1 ) ( hence has the same backoff distribution ). For ngram models , Property 5 trivially holds since BOn?1(w i?1 1 ) and ? n(w i?1 1 ) are defined as sets of sequences ending with wi?1i?n+2 and wi?1i?n+1 with the former clearly being a superset of the latter . However , when ? can be arbitrary , e.g ., a decision tree , that is not necessarily so.
Let us consider what happens when we have two context sequences W and W ? that belong to the same cluster ? n(W ) = ? n(W ?) but different backoff clusters BOn?1(W ) 6= BOn?1(W ?).
For example : suppose we have ?( wi?2wi?1) = ({ on }, { may,june }) and two corresponding backoff clusters : BO ? = ({ may }) and BO ?? = ({ june}).
Following on , the word may is likely to be a month rather than a modal verb , although the latter is more frequent and will dominate in BO ?. Therefore we have much less faith in p?(wi|BO ?) than in p?(wi|BO ??) and would like a much smaller weight ? assigned to BO ?, but it is not possible in the backoff scheme in Eq . 4, thus we will have to settle on a compromise value of ?, resulting in suboptimal performance.
We would expect this effect to be more pronounced in higher order models , because viola-der models . Indeed , in a 2gram model , the property is never violated since its backoff , unigram , contains the entire context in one cluster . The 3gram example above , ?( wi?2wi?1) = ({ on }, { may,june }), although illustrative , is not likely to occur because may in wi?1 position will likely be split from june very early on , since it is very informative about the following word . However , in a 4gram model , ?( wi?3wi?2wi?1) = ({ on }, { may,june }, {< unk >}) is quite plausible.
Thus , arbitrary clustering ( an advantage of DTs ) leads to violation of Property 5, which , we argue , may lead to a degradation of performance if backoff interpolation Eq . 4 is used . In the next section , we generalize the interpolation scheme which , as we show in Section 6, allows us to find a better solution in the face of the violation of Property 5.
4 Linear Interpolation
We use linear interpolation as the baseline , represented recursively , which is similar to Jelinek-Mercer smoothing for ngram models ( Jelinek and
Mercer , 1980): p?n(wi|w i?1 i?n+1) = ? n(?n ) ? pn(wi|?n ) + (6) (1? ? n(?n )) ? p?n?1(wi|w i?1 i?n+2) where ? n ? ? n(w i?1 i?n+1), and ? n(?n ) ? [0, 1] are assigned to each cluster and are optimized on a heldout set using EM . pn(wi|?n ) is the probability distribution at the cluster ? n in the tree of order n . This interpolation method is particularly useful as , unlike count-based discounting methods ( e.g ., Kneser-Ney ), it can be applied to already smooth distributions pn2.
5 Generalized Interpolation
We can unwind the recursion in Eq . 6 and make substitutions : ? n(?n ) ? ?? n(?n ) (1? ? n(?n )) ? ? n?1(?n?1) ? ?? n?1(?n?1) ...
2In decision trees , the distribution at a cluster ( leaf ) is often recursively interpolated with its parent node , e.g . ( Bahl et al , 1990; Heeman , 1999; Filimonov and Harper , 2009).
p?n(wi|w i?1 i?n+1) = n ? m=1 ?? m(?m ) ? pm(wi|?m ) (7) n ? m=1 ?? m(?m ) = 1 Note that in this parameterization , the weight assigned to pn?1(wi|?n?1) is limited by (1??n(?n )), i.e ., the weight assigned to the higher order model.
Ideally we should be able to assign a different set of interpolation weights for every eligible combination of clusters ? n , ? n?1, . . . , ?1. However , not only is the number of such combinations extremely large , but many of them will not be observed in the training data , making parameter estimation cumbersome.
Therefore , we propose the following parameterization for the interpolation of decision tree models : p?n(wi|w i?1 i?n+1) = ? n m=1 ? m(?m ) ? pm(wi|?m)?n m=1 ? m(?m ) (8) Note that this parameterization has the same number of parameters as in Eq . 7 ( one per cluster in every tree ), but the number of degrees of freedom is larger because the the parameters are not constrained to sum to 1, hence the denominator.
In Eq . 8, there is no explicit distinction between higher order and backoff models . Indeed , it acknowledges that lower order models are not backoff models when Property 5 is not satisfied . However , it can be shown that Eq . 8 reduces to Eq . 6 if Property 5 holds . Therefore , the new parameterization can be thought of as a generalization of linear interpolation . Indeed , suppose we have the parameterization in Eq . 8 and Property 5. Let us transform this parameterization into Eq . 7 by induction . We define : ? m ? m ? k=1 ? k ; ? m = ? m + ? m?1 where , due to space limitation , we redefine ? m ? ? m(?m ) and ? m ? ? m(?m ); ? m ? ? m(w i?1 1 ), i.e ., the cluster of model order m , to which the sequence wi?11 belongs . The lowest order distribution p1 is not interpolated with anything , hence : ?1p?1(wi|?1) = ?1p1(wi|?1) Now the induction step . From Property 5, it follows that ? m ? ? m?1, thus , for all sequences in ? wn1 ? order Jelinek-Mercer Mod KN word-tree syntactic word-tree syntactic 2gram 270.2 261.0 257.8 214.3 258.1 214.6 3gram 186.5 (31.0%) 174.3 (33.2%) 168.7 (34.6%) 156.8 (26.8%) 168.4 (34.8%) 155.3 (27.6%) 4gram 177.1 (5.0%) 161.7 (7.2%) 164.0 (2.8%) 156.5 (0.2%) 155.7 (7.5%) 147.1 (5.3%) Table 1: Perplexity results on PTB WSJ section 23. Percentage numbers in parentheses denote the reduction of perplexity relative to the lower order model of the same type . ? Word-tree ? and ? syntactic ? refer to DT models estimated using words only ( Eq . 2) and words and tags jointly ( Eq . 3).
?m , we have the same distribution : ? mpm(wi|?m ) + ? m?1p?m?1(wi|?m?1) = = ? m ( ? m ? m pm(wi|?m ) + ? m?1 ? m p?m?1(wi|?m?1) ) = ? m ( ?? mpm(wi|?m ) + (1? ?? m)p?m?1(wi|?m?1) ) = ? mp?m(wi|?m ) ; ?? m ? ? m ? m Note that the last transformation is because ? m ? ? m?1; had it not been the case , p?m would depend on the combination of ? m and ? m?1 and require multiple parameters to be represented on its entire domain wn1 ? ? m . After n iterations , we have : n ? m=1 ? m(?m)pm(wi|?m ) = ? np?n(wi|?n ); ( cf . Eq . 8) Thus , we have constructed p?n(wi|?n ) using the same recursive representation as in Eq . 6, which proves that the standard linear interpolation is a special case of the new interpolation scheme , which occurs when the backoff Property 5 holds.
6 Results and Discussion
Models are trained on 35M words of WSJ 9496 from LDC2008T13. The text was converted into speech-like form , namely numbers and abbreviations were verbalized , text was downcased , punctuation was removed , and contractions and possessives were joined with the previous word ( i.e ., they ? ll becomes they?ll ). For syntactic modeling , we used tags comprised of POS tags of the word and its head , as in ( Filimonov and Harper , 2009). Parsing of the text for tag extraction occurred after verbalization of numbers and abbreviations but before any further processing ; we used an appropriately trained latent variable PCFG parser ( Huang and Harper , 2009). For reference , we include ngram models with Jelinek-Mercer and modified interpolated KN discounting . All models use the same vocabulary of approximately 50k words.
We implemented four decision tree models3: two using the interpolation method of ( Eq . 6) and two based on the generalized interpolation ( Eq . 8). Parameters ? were estimated using the LBFGS to minimize the entropy on a heldout set . In order to eliminate the influence of all factors other than the interpolation , we used the same decision trees . The perplexity results on WSJ section 23 are presented in Table 1. As we have predicted , the effect of the new interpolation becomes apparent at the 4gram order , when Property 5 is most frequently violated . Note that we observe similar patterns for both word-tree and syntactic models , with syntactic models outperforming their word-tree counterparts.
We believe that ( Xu and Jelinek , 2004) also suffers from violation of Property 5, however , since they use a heuristic method4 to set backoff weights , it is difficult to ascertain the extent.
7 Conclusion
The main contribution of this paper is the insight that in the standard recursive backoff there is an implied relation between the backoff and the higher order models , which is essential for adequate performance . When this relation is not satisfied other interpolation methods should be employed ; hence , we propose a generalization of linear interpolation that significantly outperforms the standard form in such a scenario.
3We refer the reader to ( Filimonov and Harper , 2009) for details on the tree construction algorithm.
4The higher order model was discounted according to KN discounting , while the lower order model could be either a lower order DT ( forest ) model , or a standard ngram model , with the former performing slightly better.
623
References
Lalit R . Bahl , Peter F . Brown , Peter V . de Souza , and Robert L . Mercer . 1990. A tree-based statistical language model for natural language speech recognition.
Readings in speech recognition , pages 507?514.
Stanley F . Chen and Joshua Goodman . 1999. An empirical study of smoothing techniques for language modeling . Computer Speech & Language , 13(4):359?393.
Denis Filimonov and Mary Harper . 2009. A joint language model with fine-grain syntactic tags . In Proceedings of the EMNLP.
Peter A . Heeman . 1999. POS tags and decision trees for language modeling . In Proceedings of the Joint SIGDAT Conference on Empirical Methods in Natural Language Processing and Very Large Corpora , pages 129?137.
Zhongqiang Huang and Mary Harper . 2009. Self-Training PCFG grammars with latent annotations across languages . In Proceedings of the EMNLP 2009.
Frederick Jelinek and Robert L . Mercer . 1980. Interpolated estimation of markov source parameters from sparse data . In Proceedings of the Workshop on Pattern Recognition in Practice , pages 381?397.
Peng Xu and Frederick Jelinek . 2004. Random forests in language modeling . In Proceedings of the EMNLP.
624
