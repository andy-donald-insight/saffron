Parsing for Semidirectional Lambek Grammar is NP -Complete 
Jochen Dfrre
Institutffir maschinelle Sprachverarbei tung 
University of Stuttgart

We study the computational complexity of the parsing problem of a variant of Lambek Categorial Grammar that we call semidirectional  . In semidirectional Lambek calculus SD\[there is an additional nondirectional abstraction rule allowing the formula abstracted over to appear anywhere in the premise sequent's lefthand side  , thus permitting non-peripheral extraction . SD\[grammars are able to generate each contextfree language and more than that  . We show that the parsing problem for semidireetional Lambek Grammar is NP-complete by a reduction of the  3- 
Partition problem.
Keywords : computational complexity,
Lambek Categorial Grammar 1 Introduction Categorial Grammar ( CG ) and in particular Lambek Categorial Grammar ( LCG ) have their wellknown benefits for the formal treatment of natural language syntax and semantics  . The most outstanding of these benefits is probably the fact that the specific way  , how the complete grammar is encoded , namely in terms of ' combinatory potentials ' of its words  , gives us at the same time recipes for the construction of meanings  , once the words have been combined with others to form larger linguistic entities  . Although both frameworks are equivalent in weak generative capacity -- both derive exactly the contextfree languages --  , LCG is superior to CG in that it can cope in a natural way with extraction and unbounded e -pendency phenomena  . For instance , no special category assignments need to be stipulated to handle a relative clause containing a trace  , because it is analyzed , via hypothetical reasoning , like a traceless clause with the trace being the hypothesis to be discharged when combined with the relative pronoun  . 
Figure 1 illustrates this proof-logical behaviour . Notice that this natural-deduction-style proof in the type logic corresponds very closely to the phrase-structure tree one would like to adopt in an analysis with traces  . We thus can derive Bill misses ~ as ans from the hypothesis that there is a " phantom " np in the place of the trace  . Discharging the hypothesis , indicated by index 1 , results in Bill misses being analyzed as ans /np from zero hypotheses  . Observe , however , that such a bottom-up synthesis of a new unsaturated type is only required  , if that type is to be consumed ( as the antecedent of an implication ) by another type . Otherwise there would be a simpler proof without this abstraction  . In our example the relative pronoun has such a complex type triggering an extraction  . 
A drawback of the pure Lambek Calculus !_ is that it only allows for so called ' peripheral extraction '  , i . e . , in our example the trace should better be initial or final in the relative clause  . 
This inflexibility of Lambek Calculus is one of the reasons why many researchers study richer systems today  . For instance , the recent work by Moortgat ( Moortgat 94 ) gives a systematic indepth study of mixed Lambek systems  , which integrate the systems L , NL , NLP , and LP . These ingredient systems are obtained by varying the Lambek calculus along two dimensions : adding the permutation rule  ( P ) and/or dropping the assumption that the type combinator  ( which forms the sequences the systems talk about ) is associative ( N for non-associative )  . 
Taken for themselves these variants of I_are of little use in linguistic descriptions  . But in Moortgat's mixed system all the different resource management modes of the different systems are left intact in the combination and can be exploited in different parts of the grammar  . The relative pronoun which would , for instance , receive category ( np\np ) / ( np--os ) with--obeing implication in LP , 1 i . e . , it requires 1The Lambek calculus with permutation I_P is also called the " nondirectional Lambek calculus "  ( Ben-them 88 )  . In it the leftward and rightward implication ( np\np ) / ( s/np ) missese ( n ; \8)/n ; 
Bill ~ ~ np np\s s/npl np\np
Figure 1: Extraction as resource-conscious hypothetical reasoning as an argument " anslacking an np somewhere "  . 2 . 
The present paper studies the computational complexity of a variant of the Lambek Calculus that lies between / and tP  , the Semi directional Lambek Calculus SDk .   3 Since tP derivability is known to be NP-complete , it is interesting to study restrictions on the use of the I_P operator-o  . A restriction that leaves its proposed linguistic applications in tact is to admit a type B-oA only as the argument ypein functional applications  , but never as the functor . Stated prove-theoretically for Gentzen-style systems  , this amounts to disallowing the left rule for- o  . Surprisingly , the resulting system SD\[ . can be stated without the need for structural rules  , i . e . , as a monolithic system with just one structural connective  , because the ability of the abstracted-over formulato permute can be directly encoded in the right rule for--o  .   4 Note that our purpose for studying SDI_is not that it might be in any sense better suited for a theory of grammar  ( except perhaps , because of its simplicity ) , but rather , because it exhibits a core of logical behaviour that any richer system also needs to include  , at least if it should allow for non-peripheral extraction  . The sources of complexity uncovered here are thus a forteriori present in all these richer systems as well  . 

2 Morrill ( Morrill 94 ) achieves the same effect with a permutation modality/k apphed to the np gap:  ( s/Anp ) S This name was coined by Esther K6 nig-Baumer , who employs a variant of this calculus in her LexGram system  ( KS nig 95 ) for practical grammar development . 
4It should be pointed out that the resource management in this calculus is very closely related to the han-dhng and interaction of local valency and unbounded dependencies in HPSG  . The latter being handled with set-valued features SLASH  , QUE and KEL essentially emulates the permutation potential of abstracted categories in semidirectional Lambek Grammar  . A more detailed analysis of the relation between HPSG and SD\[isgiven in  ( KS nig 95 )  . 
2 Semidirectional Lambek Grammar 2 . 1 Lambek ca lcu lus The semidirectional Lambek calculus  ( henceforth SDL ) is a variant of J . Lambek's original ( Lambek 58 ) calculus of syntactic types . We start by defining the Lambek calculus and extend it to obtain SDL  . 
Formulae ( also called " syntactic types " ) are built from a set of propositional variables ( or " primitive types " ) B = bl , b2 ,  . . . and the three binary connectives ? ,  \  ,  /  , called product , left implication , and right implication . We use generally capitaletters A,B,C, .   .   . to denote formulae and capitals towards the end of the alphabet T  , U , V ,   .   .   . to denote sequences of formulae . The concatenation of sequences U and
V is denoted by ( U , V).
The ( usual ) formal framework of these logics is a Gentzen -style sequent calculus  . Sequents are pairs ( U , A ) , written as U = ~ A , where A is a type and U is a sequence of types .   5 The claim embodied by sequent U = ~ A can be read as " formula A is derivable from the structured database U "  . Figure 2 shows
Lambek's original calculust.
First of all , since we don't need products to obtain our results and since they only complicate matters  , we eliminate products from consideration i these -quel  . 
In Semidirectional Lambek Calculus we add as additional connective the \[_P implication --% but equipit only with a right rule  . 
U , B , V := ~ A(-oR ) if T = ( U , Y ) nonempty . T : ~ B--o A 5In contras to Linear Logic ( Girard 87 ) the order of types in U is essential , since the structural rule of permutation is not assumed to hold  . Moreover , the fact that only a single formula may appear on the right of ~  , make the Lambek calculus an intuitionistic fragment of the multiplicative fragment of non -commutative propositional Linear Logic  . 
96 ( Ax )
T ~ BU , A , V = ~ C
U , A/B , T , V = ~ C(/L)
U , B ~ A
U :: ~ A/B (/1~) if U nonempty
T::vBU,A,V=vC
U , T , B\A , V = ~ C(\L)
B , U ~ A
U = ~ B\A(\R ) if U nonempty
U , A , B , V = ~ C (. L)
U , AoB , V = ~ C
UsAV ~ B (. R)
U , V = ~ A . B
T ~ AU , A , V = ?, C(Cut)
U , T , V = ~ U
Figure 2: Lambek calculus L
Let us define the polarity of a subformula of a sequent  A1  ,  ? ? . , Am ::~ A as follows : A has positive polarity , each of A i have negative polarity and if B/C or C \B has polarity p  , then B also has polarity p and C has the opposite polarity of p in the sequent  . 
A consequence of only allowing the (- oR ) rule , which is easily proved by induction , is that in any derivable sequent--o may only appear in positive polarity  . Hence , -o may not occur in the ( cut ) formula A of a ( Cut ) application and any subformula B-oA which occurs somewhere in the prove must also occur in the final sequent  . When we assume the final sequent's RHS to be primitive  ( or--o-less )  , then the ( - oR ) rule will be used exactly once for each ( positively ) occuring-o-subformula . In other words ,   ( - oR ) may only do what it is supposed to do: extraction  , and we can directly read off the category assignment which extractions there will be  . 
We can show Cut Elimination for this calculus by a straightforward adaptation of the Cut elimination proof for L  . We omit the proof for reasons of space . 
Proposition 1 ( Cut Elimination ) Each
SDL-derivable sequent has a cut-free proof.
The cut-free system enjoys , as usual for Lambek-like logics , the Subformula Property : in any proof only subformulae of the goal sequent may appear  . 
In our considerations below we will make heavy use of the wellknown count invariant for Lambek systems  ( Benthem 88 )  , which is an expression of the resource -consciousness of these logics  . Define  #b(A ) ( the b-count of A) , a function counting positive and negative occurrences of primitive type bin an arbi-if A = b if A primitive and A ~ b  #b  ( A ) =  #b ( B ) -#b ( C ) if A = B/CorA = V\B or A = C-oB\[ .  #b(B ) + #b(C ) if A = B . C The invariant now states that for any primitive b  , the b-count of the RHS and the LHS of any derivable sequent are the same  . By noticing that this invariant is true for ( Ax ) and is preserved by the rules , we immediately can state : Proposition 2 ( Count Invariant ) If I-sbLU == ~
A , then  #b(U ) =  #b(A ) fo ~ any b~t  ~ .
Let us in parallel to SDL consider the fragment of it in which  ( /R ) and ( \R ) are disallowed . We call this fragment SDL- . Remarkable about this fragment is that any positive occurrence of an implication must be-- o and any negative one must be/or\  . 
2.2 Lambek Grammar
Definition 3 We define a Lambek grammar to be a quadruple ( E , ~ r , bs , l ) consisting of the finite alphabet of terminals E , the set jr of all Lambek formulae generated from some set of propositional variables which includes the distinguished variables  , and the lezical map l : ~ ,  --*  2   7 which maps each terminal to a finite subset of f  . 
We extend the lexical mapl to nonempty strings of terminals by setting l  ( wlw2 . .  . w ~) := l(wl ) ? l(w ~) x . . . xl(w ,) for wl w2 .   .   . wnE ~+ . 
The language generated by a Lambekgrammar G = (~ , ~' , bs , l ) is defined as the set of all strings wlw ~ . .  . wnE~+for which there exists a sequence x == ~ x x ==~x 
B ~, B2, C ~, C2, c n + l , b n + y (*)
B ~, B2, C ~, C2, cn , bn~c--o(b--oy)
A2 , B\[ , B2 , C  ~ , C2 , cn , bn=*xn--1A1 , A2 , B  ~ , B2 , C  ~ , C2 , c , b = vxA~-1 , A2 , B ~' , B2 , C  ~ , C2=~c-0(b-0x )
A ?, A2, B~, B2, C ~, C2 = => x
Figure 3: Proof of A ~ , A2 , B  ~ , B2 , C  ~ , C2=~z2x ( - on )   ( \] L ) 2x ( -- on )   ( /L ) of types UE l ( wlw2 .   .   . wn ) and kkU~bs . We denote this language by L(G ) . 
An SDL-grammar is defined exactly like a Lambek grammar  , except hatk SDk replaces kl_ . 
Given a grammar G and a string w = W l W 2 . . . wn , the parsing ( or recognition ) problem asks the question , whether w is in L(G ) . 
It is not immediately obvious , how the generative capacity of SDL-grammars relate to Lambek grammars or nondirectional Lambek grammars  ( based on calculus LP )  . Whereas Lambek grammars generate exactly the contextfree languages  ( modulo the missing empty word )   ( Pentus 93 )  , the latter generate all permutation closures of contextfree languages  ( Benthem 88 )  . This excludes many contextfree or even regular languages  , but includes some context-sensitive ones , e . g . , the permutation closure of an bncn . 
Concerning SD\[ , it is straightforward to show that all contextfree languages can be generated by SDL -grammars ? Proposition  4 Every contextfree language is generated by some SDL-grammar  . 
Proof . We can use a the standard transformation of an arbitrary cfr  . grammar G = ( N , T , P , S ) to a categorial grammar G ' . Since-o does not appear in G ' each SDl_-proof of a lexical assignment must be also an I_ -proof  , i . e . exactly the same strings are judged grammatical by SDL as are judged by L  . D Note that since the ( Ax ) , (/ L ) , (\L ) subset of I_already accounts for the cfr . languages , this observation extends to SDL- . 
Moreover , some languages which are not contextfree can also be generated  . 
Example . Consider the following grammar G for the language an bncn  . We use primitive types B =  b , c , x , y , z and define the lexical map for E = l ( a ) := x/ ( c - - - o ( b-ox ) ) , xl ( c - - - o ( b-oy ) )  =  ) 4 1  =  A2 - - -- CI = C2 The distinguished primitive type is x ? To simplify the argumentation  , we abbreviate types as indicated above ? Now , observe that a sequent U = ~ x , where U is the image of some string over E , only then may have balanced primitive counts , if U contains exactly one occurrence of each of A2  , B2 and C2 ( accounting for the one supernumerary x and balanced y and z counts  ) and for some number n >_0 , n occurrences of each of A1 , B 1 , and C1 ( because , resource-oriented speaking , each Bi and Ci " consume " ab and c , resp . , and each Ai " provides " a pair b , c) . Hence , only strings containing the same number of a's , b's and c's may be produced . Furthermore , due to the Sub formula Property we know that in a cut-free proof of U~x  , them Mn formula in abstractions ( right rules ) may only be either c-o ( b--oX ) or b-oX , where XE x , y , since all other implication types have primitive antecedents  . Hence , the LHS of any sequent in the proof must be a subsequence of U  , with some additional btypes and ctypes interspersed  . 
But then it is easy to show that U can only be of the form 
Anl , A2 , B  ~ , B2 , C  ~ , C2 , since any/connective in U needs to be introduced via  ( /L )  . 
It remains to be shown , that there is actually a proof for such a sequent ? It is given in Figure  3  . 
The sequent marked with * is easily seen to be derivable without abstractions  . 
A remarkable point about SDL'sability to cover this language is that neither Ln or LP can generate it  . 
Hence , this example substantiates the claim made in ( Moortgat 94 ) that the inferential capacity of mixed Lambek systems may be greater than the sum of its component parts  . Moreover , the attentive reader will have noticed that our encoding also extends to languages having more groups of n symbols  , i . e . , to languages of the form n nnala 2 .   .   . ak ? Finally , we note in passing that for this grammar the rules  ( /R ) and ( \R ) are irrelevant , i . e . that it is at the same time an SOL-grammar . 
3 NP-Completeness of the Parsing

We show that the Parsing Problem for SDL-grammars is NP-complete by a reduction of the  3-Partition Problem to it . 6 This wellknown NP-complete problem is cited in ( Garey Johnson 79 ) as follows . 
Instance : Set , 4 of 3m elements , abound NE
Z + , and a sizes ( a ) EZ + for each a E`4 such that ~< s ( a ) < ~- and ~ o~s ( a ) = mN . 
Question : Can ` 4 be partitioned into m disjoint sets ` 41  , `42  ,   .   .   . , Am such that , for 1<i<m , ~ ae . as ( a ) = N ( note that each `4i must ' therefore contain exactly 3 elements from ` 4  ) ? Comment : NP-complete in the strong sense . 
Here is our reduction . Let F = (`4 , m , N , s ) be a given 3-Partition instance . For notational convenience we abbreviate ( .   .   . (( A/BI)/B ~)/ .   .   . )/ Bn by A/B ~? .   .   . ? B2 ? B1 and similarly B,-o ( .   .   . ( B1--oA ) .   .   . ) by Bn ? .   .   . ? B2 ? B1--oA , but note that this is just an abbreviation i the product-free fragment  . 
Moreover the notation Ak stands for
AoAo ... oAkt ~ mes
We then define the SDL-grammar Gr = (~ ,  ~ , bs , l ) as follows : p , := v , wl ,  .   .   .   , warn 5 t ":= all formulae over primitive types mbB = a  , dUUi = , i , c , : bs:--=a ? for l < i < 3r n-l:l(w i ) := UJ . < . /< md/d?bj?c : ( ~' ) 6 A similar reduction has been used in ( Lincoln Win-kler 94 ) to show that derivability in the multiplicative fragment of propositional Linear Logic with only the connective s--o and @  ( equivalently Lambek calculus with permutation LP ) is NP-complete . 

The word we are interested in is v wlw2 . . w3m.
We do not care about other words that might be generated by Gr  . Our claim now is that a given 3-Partition problem F is solvable if and only if v w l .   .   . w3m is in L(Gr ) . We consider each direction in turn . 
Lemma 5 ( Soundness ) If a 3-Partition problem F = ( A , m , N , s ) has a solution , then vw l .   .   . w3m is in/(Gr ) . 
Proof . We have to show , when given a solution to F , how to choose a type sequence U~l(vwl .   .   . wzm ) and construct an SDL proof for U == ~ a . Suppose `4 = al , a2, .   .   . , a3m . From a given solution ( set of triples ) A1, `4~, . .  .   , -Am we can compute in polynomial time a mapping k that sends the index of an element othe index of its solution triple  , i . e . , k(i ) = j iff aie `4j . To obtain the required sequence U , we simply choose for the witerminals the type ? cS  ( a3"~ ) ? c  ~ ( "~ )   ( resp . d/bk(3m ) k(3m ) for W3m ) . did ? bk ( i ) k ( i ) Hence the complete sequent o solve is : Nd ) a / ( b3 ? b3? .   .   . ? b3macN ? cN ? .   .   . ? cm-odid ? bko ) ?% (1) cS(a3, .  -1 )   ( * ) did ? bk ( 3m-1 ) ? k ( am-1 ) dlb ? cS ( a3" ) /k ( 3 m ) k ( zm ) Leta/Bo , B 1 ,   .   .   . B3m ~ a be a shorthand for (*) , and let X stand for the sequence of primitive types c ~  (  , ,~ ,  . ) c~(,~ . , , -~) c~( , ~ , ) bk(3m ) , k (3m ) , bk(3m-l ) , k (3 , ~_l ) ,   .   .   . bko ) , k(1) " Using rule (/ L ) only , we can obviously prove B1 ,   .   .   . B3m , X::~d . Now , applying ( -- oR ) 3 m+N m times we can obtain B1 ,   .   .   . B3m=~B0 , since there are in total , for each i , 3 bi and Nci in X . As final step we have
BI , .   .   . B3m ~ B0a ~ aa/Bo , BI, .   .   . B3m ~ a(/L ) which completes the proof . \[\] Lemma 6 ( Completeness ) Let F = ( . 4 , m , N , s ) be an arbitrary 3-Partit ion problem and Gr the corresponding SDL-grammar as defined above  . Then F has a solution , if v w l .   .   . w3m is in L(Gr ) . 
Proof . Let v wl .   .   . W3m6L(Gr ) and Nd ), B1, . ? ? Bsm ~ aa / ( b ? .   .   .   .   . em-obea witnessing derivable sequent , i . e . , for 1<i < 3m , BiEl(wi) . Now , since the counts of this sequent must be balanced  , the sequence B1 ,   .   .   .   B3m must contain for each 1 _ < j < m exactly 3 bj and exactly Ncj as subformulae . Therefore we can read off the solution to F from this sequent by including in Aj  ( for 1 < j < m ) those three ai for which Bi has an occurrence of bj  , say these areaj (1) , aj(2) and aj (3) . We verify , again via balancedness of the primitive counts , that s(aj(1)) ? s(aj(2)) + s(aj(3)) = N holds , because these are the numbers of positive and negative occurrences of cj in the sequent  . This completes the proof . \[\] The reduction above proves NP-hardness of the parsing problem  . We need strong NP-completeness of 3-Partition here , since our reduction uses a unary encoding . Moreover , the parsing problem also lies within NP , since for a given grammar G proofs are linearly bound by the length of the string and hence  , we can simply guess a proof and check it in polynomial time  . Therefore we can state the following : Theorem 7 The parsing problem for SDI_is NP-complete . 
Finally , we observe that for this reduction the rules ( /R ) and ( \R ) are again irrelevant and that we can extend this result to SDI_-  . 
4 Conclusion
We have defined a variant of Lambek's original calculus of types that allows abstracted-over categories to freely permute  . Grammars based on SOl-can generate any contextfree language and more than that  . The parsing problem for SD\[ , however , we have shown to be NP-complete . This result indicates that efficient parsing for grammars that allow for large numbers of unbounde dependencies from within one node may be problematic  , even in the categorial framework . Note that the fact , that this problematic case doesn't show up in the correct analysis of normal NL sentences  , doesn't mean that a parser wouldn't have to try it  , unless some arbitrary bound to that number is assumed  . For practical grammar engineering one can devise the mottoavoid accumulation of unbounded ependencies by whatever means  . 
On the theoretical side we think that this result for  S01 is also of some importance , since SDI_exhibits a core of logical behaviour that any  ( Lambek-based ) logic must have which accounts for non-peripheral extraction by some form of permutation  . And hence , this result increases our understanding of the necessary computational properties of such richer systems  . To our knowledge the question , whether the Lambek calculus itself or its associated parsing problem are NP-hard  , are still open . 

J . van Benthem . The Lambek Calculus . In R . T . O . 
et al(Ed . ) , Categorial Grammars and Natural Language Structures  , pp .  35-68 . Reidel , 1988 . 
M . R . Garey and D . S . Johnson . Computers and Intractability -- A Guide to the Theory of NP-Completeness  . Freeman , San Francisco , Cal . , 1979 . 
J . -Y . Girard . Linear Logic . Theoretical Computer
Science , 50(1):1-102, 1987.
E . Khnig . LexGram-a practical categorial grammar formalism  . In Proceedings of the Workshop on Computational Logic for Natural Language Processing  . A Joint COMPULOGNET/ELSNET/EAGLES Workshop , Edinburgh , Scotland , April 1995 . 
J . Lambek . The Mathematics of Sentence Structure . American Mathematical Monthly ,  65(3):154-170 ,  1958 . 
P . Lincoln and T . Winkler . Constant-Only Multiplicative Linear Logicis NP -Complete  . Theoretical Computer Science ,  135(1):155-169 , Dec .  1994 . 
M . Moortgat . Residuation in Mixed Lambek Systems . In M . Moortgat ( Ed . ), Lambek Calculus . Multimodal and Polymorphic Extensions , DYANA-2 de-liverable RI . I . B . ESPRIT , Basic Research Project 6852, Sept .  1994 . 
G . Morrill . Type Logical Grammar : Categorial Logic of Signs . Kluwer , 1994 . 
M . Pentus . Lambek grammars are contextfree . In Proceedings of Logic in Computer Science , Montreal ,  1993 . 

