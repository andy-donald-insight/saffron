# Saffron 3 - Formats
===================

This document describes the formats used and generated by Saffron 3. <br/>All formats are in JSON
and we will describe the properties each files has, with a link to an example (as found in the [examples](https://gitlab.insight-centre.org/saffron/saffron/blob/saffron_development/examples/) folder)

## Input formats

### Corpus  ([corpus_with_authors.json](https://gitlab.insight-centre.org/saffron/saffron/blob/issue215/examples/corpus_with_authors.json))
------

This file contains the description of the corpus, including all the metadata. It is a collection of documents, each element being a different dicument with its own metadata and link to the file containing the text. A corpus has the following properties:

* `documents`: A list of documents in the corpus

    Each element of the list should have *at least* one of the following four:

    * `file`: A string referring to the original version of this document on disk (absolute or relative path)
    * `id`: A unique string to identify the document
    * `url`: The URL of the file
    * `contents`: The text contents of the file
    
    In addition the following may be provided:
    * `name`: The human readable name of the document
    * `mime_type`: The MIME type of the document
    * `authors`: An array of authors of this document
            
        For each author of the document, provide:
        - Either the name of the author as a string
        - Or if more details on the author:
            * `name`: The author's name (required)
            * `id`: A unique string to identify the author (optional)
            * `name_variants`: An array of strings given other known variants of the name (optional)
            
    * `metadata`: An object containing any other properties
        Each property is in the form: 
        
            "property name":"property value", separated by commas


### Config ([config.json](https://gitlab.insight-centre.org/saffron/saffron/blob/saffron_development/examples/config.json))

This input file for the command line interface (generated automatically if using the user interface) describes all options from the different steps of Saffron.
See the [wiki](https://gitlab.insight-centre.org/saffron/saffron/wikis/saffron-approach) for the details on what each property is for and the scientific explaination of the method.

It contains each of the Saffron steps:

##### 1.   Term Extraction
Configuration for the options of the term extraction phase. All properties are included under the object:

* `termExtraction`: Which element contains the following properties to define:
    * `threshold` : Sets a minimum Saffron score for the terms retrieved

    * `maxTerms` : Sets the maximum number of terms to extract . Default to 100
    
    * `ngramMin` : Sets the shortest length of term to consider (in terms of number of words). Default to 1
    
    * `ngramMax` : Sets the longest length of term to consider  (in terms of number of words). Default to 4
    
    * `minTermFreq` : Sets the number of times a term must appear in the dataset to be retrieved. Default to 2
    
    * `maxDocs` : A limit on the number of documents that can be contained in the corpus (default to 2147483647) **to be checked**
    
    * `method` : Choose between two ranking procedures: "voting" (algorithm that integrates multiple score functions) and "single" (only one score function)
    
    * `features` : List of scoring functions if choosing the "Voting" method above, or will be ignored the "Single" method was chosen (by default set to [ "comboBasic", "weirdness", "totalTfIdf", "cValue", "residualIdf" ])
    
        Options are:  "comboBasic", "weirdness", "totalTfIdf", "cValue", "residualIdf", "avgTermFreq", "basic", "novelTopicModel", "postRankDC", "relevance"
                    
    * `corpus` : Path to the model that contains XYZ (by default set to ${saffron.home}/models/wiki-terms.json.gz)  **to be checked**
    
    * `baseFeature` : If `method` is set to "single", give here the unique scoring function to use .
    If `method` is set to "voting", choose the scoring function that will get more weight in the calculation of the final score. (Choose between the options given above in `features`)
    
    * `numThreads` : 0  **to be checked**
    
    * `posModel` : The path to the part-of-speech tagger's model. Only models from [OpenNLP](http://opennlp.sourceforge.net/models-1.5/) are currenlty supported (default to "${saffron.home}/models/en-pos-maxent.bin")
    
    * `tokenizerModel` : The path to the tokenizer's model.  By default set to "null" (the configuration will automatically uses the one English tokenizer that is provided by OpenNLP). Only models from [OpenNLP](http://opennlp.sourceforge.net/models-1.5/) are currenlty supported **to be checked**
    
    * `lemmatizerModel` : The path to the lemmatizer's model. Only models from [OpenNLP](http://opennlp.sourceforge.net/models-1.5/) are currenlty supported (default to"${saffron.home}/models/en-lemmatizer.dict.txt"
    
    * `stopWords` : The path to the list of stop words (one per line) if different from the [default ones](https://gitlab.insight-centre.org/saffron/saffron/blob/saffron_development/taxonomy/src/main/resources/stopwords/README)
    
    * `preceedingTokens` : The set of tags allowed in non-final position in a noun phrase. Default set to [ "NN", "JJ", "NNP", "NNS" ]
    
    * `middleTokens` : The set of tags allowed in non-final position, but not completing. Default set to [ "IN" ]
    
    * `headTokens` : The set of final tags allows in a noun phrase. Default set to [ "NN", "CD", "NNS" ]
    
    * `headTokenFinal` : The position of the head of a noun phrase (true=final). Degault set to "true"
    
    * `blacklist` : A list of terms that should never be generated. Default is an empty list
    
    * `blacklistFile` : The path to a file containing a list of black terms. Default to null
    
    * `oneTopicPerDoc` : If set always output at least one topic for each input document (overrides maxTerms if necessary). Default to false


##### 2.   Author - Term linking

* `authorTerm`: The phase of linking between authors and terms (if authors are present in the metadata, ignored otherwise)

##### 3.   Author Similarity

* `authorSim`: The phase of connecting authors together (if authors are present in the metadata, ignored otherwise)

##### 4.   Term Similarity

* `termSim`: The phase of connecting similar terms

##### 5.   Taxnomy Construction

* `taxonomy`: The phase of creation of the taxonomy

Domain Model
------------

The set of keywords that define a domain. This object has only one property

* `terms`: An array of strings containing keywords

Topic ([topics.json](https://gitlab.insight-centre.org/saffron/saffron/blob/saffron_development/examples/topics.json))
-----

A single topic in the corpus. Contains the following annotations

* `topic_string`: The string that names the topic (must be unique)
* `occurrences`: The total number of occurrences of a topic in the corpus
* `matches`: The number of documents in the corpus containing this topic
* `score`: The importance of the topic to this corpus (between 0 and 1)
* `mv_list`: A list of alternative (morphological variants) forms of this 
topic string
* `dbpedia_url`: The equivalent topic in DBpedia

### Morphological Variants

A variant form of a topic

* `string`: The form of this variant

Taxonomy  ([taxonomy.json](https://gitlab.insight-centre.org/saffron/saffron/blob/saffron_development/examples/taxonomy.json))
--------

The topic taxonomy containing the following

* `root`: The topic string of this topic or `""` for no topic
* `children`: A list of children of this node (these are also Taxonomy objects)
* `score`: The weighting given to the root topic
* `linkScore`: The likelihood of the link from this topic to its root being correct

Author-Author
-------------

An edge in the author-author graph

* `author1_id`: The ID of the first author
* `author2_id`: The ID of the second author
* `similarity`: The similarity score between these authors

Author-Topic
------------

An edge linking an author to a topic

* `author_id`: The ID of the author
* `topic_id`: The topic string of the topic
* `matches`: The number of times this topic is used in documents by this author
* `occurrences`: The number of documents by this author containing the topic
* `tfirf`: The Term Frequency-Inverse Research Frequency (See "Domain adaptive 
extraction of topical hierarchies for Expertise Mining" (Georgeta Bordea (2013)) 
for evaluations of different methods)
* `score`: The score of the this linking
* `researcher_score`: Score for author's ranking for this particular topic

Document-Topic ([doc-topics.json](https://gitlab.insight-centre.org/saffron/saffron/blob/saffron_development/examples/doc-topics.json))
--------------

The connection between a document and a topic

* `document_id`: The ID of the document
* `topic_string`: The topic string of the topic
* `occurrences`: The number of times this topic occurs in this document
* `pattern`: The pattern used to match the topic
* `acronym`: The acronym form (if any)
* `score`: The weight of this link
* `tfidf`: Saffron internal value
* `unembedded_occ`: Saffron internal value

Topic-Topic ([topic-sim.json](https://gitlab.insight-centre.org/saffron/saffron/blob/saffron_development/examples/topic-sim.json))
-----------

An edge in the topic-topic graph

* `topic1`: The first topic's topic string
* `topic2`: The second topic's topic string
* `similarity`: The similarity of the two topics


