<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Saffron - Extracting the Valuable Threads of Expertise</title>
        <link rel="icon" type="image/png" href="/img/favicon.png">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
        <link href="https://fonts.googleapis.com/css?family=Belleza" rel="stylesheet">
        <style>
            body {
                background-color: #fff7e5;
                font-family: 'Belleza', sans-serif;
            }
            .logo_header {
                padding-top:20px;
                padding-bottom:20px;
                text-align: center;
            }
            .ack {
                font-size: .7em;
                padding-top:20px;
            }
            .loader {
                border: 16px solid #005495; /* Light grey */
                border-top: 16px solid #f48120; /* Blue */
                border-radius: 50%;
                width: 120px;
                height: 120px;
                animation: spin 2s linear infinite;
            }

            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }

            .failed {
                text-color: red;
            }
            #page_footer {
                border-top: 1px solid #CCCCCC;
                background-color: #F0F0F0;
                padding-top: 0px;
                padding-bottom: 5px;
                font-size: 0.8em;

                position:relative;
                position: absolute;
                bottom: 0px;
                left: 0px;
                width: 100%;
                height: 117px;
            }
            #page_footer div {
                text-align: center;
            }
            #page_footer p {
                margin: 0;
                padding: 0;
                color: #404040;
            }

            #insight_logo {
                background-color: #FFFFFF;
                border: 1px solid #AAAAAA;
                padding: 4px 8px;
            }

            #nui_logo {
                position: relative;
                margin-left: 10px;
                border: none;
            }

            #sfi_logo {
                position: relative;
                left: -30px;
                top: 7px;
                border: none;
            }

        </style>
    </head>
    <body>
        <div class="container">
            <div class="row">
                <div class="col-md-12 logo_header">
                    <img src="img/saffron-logo.png"/>
                </div>
            </div>
            <div class="row" style="padding-top:150px;">
                <div class="col-md-5"></div>
                <div class="col col-auto">
                    <div class="loader"></div>

                </div>
                <div class="col-md-5"></div>
            </div>
            <div class="row" ng-app="app" style="padding-top:40px;padding-bottom:200px;">
                <div class="col-md-3"></div>
                <div class="col-md-6" style="text-align:center;">
                    <div ng-controller="StatusController" ng-class="{failed: data.failed}">
                        Stage {{data.stage}}: {{data.statusMessage}}
                    </div>
                </div>
                <div class="col-md-3"></div>
            </div>

        </div>
        <div style="clear:both;"></div>
        <div id="page_footer">
            <div>
                <a href="http://www.insight-centre.org/"><img width="81" height="40" id="insight_logo" alt="INSIGHT" src="/img/insight.png" /></a>
                <a href="http://www.nuigalway.ie/"><img width="176" height="50" id="nui_logo" alt="NUI Galway" src="/img/nuigalway.png" /></a>
                <a href="http://www.sfi.ie/"><img width="175" height="75" id="sfi_logo"	alt="SFI" src="/img/sfi.png" /></a>
                <p>This resource has been funded by Science Foundation
                    Ireland under Grant No. SFI/08/CE/I1380 (Lion-2) and by Grant No. SFI/12/RC/2289 (INSIGHT)</p>
                <p>INSIGHT - National University of Ireland, Galway</p>
            </div>
        </div>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.js"></script>
        <script>
            angular.module('app', []);
            angular.module('app').controller('StatusController', function ($scope, $timeout, $http) {
                $scope.data = {};
                (function tick() {
                    $http.get("/execute/status?name={{name}}").then(function (response) {
                        $scope.data = response.data;
                        if ($scope.data.completed) {
                            window.location = "/{{name}}/";
                        } else if($scope.data.advanced) {
                            window.location = "/execute?name={{name}}";
                        }
                        $timeout(tick, 100);
                    }, function(error) {
                        // Probably a dead run
                        window.location = '/';
                    });
                })();
            });
        </script>
    </body>

</html>